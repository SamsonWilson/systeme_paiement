{% extends "accuiel/base.html" %}
{% load widget_tweaks %}
{% block content %}
<h2>Tableau de bord de {{ locataire.nom }} {{ locataire.prenom }}</h2>
<p>Email : {{ locataire.email }}</p>
<p>Téléphone : {{ locataire.telephone }}</p>
<h3>Résumé</h3>
<ul>
    <li>Montant total dû : {{ montant_total }} FCFA</li>
    <li>Montant payé : {{ montant_paye }} FCFA</li>
    <li>Montant restant : {{ montant_restant }} FCFA</li>
</ul>
<h3>Locations Actuelles</h3>
{% if locations %}
<table border="1">
    <thead>
        <tr>
            <th>Chambre</th>
            <th>Début</th>
            <th>Montant Total</th>
            <th>Statut</th>
            <th>Paiements</th>
        </tr>
    </thead>
    <tbody>
    {% for location in locations %}
        <tr>
            <td>{{ location.chambre }}</td>
            <td>{{ location.date_debut_location }}</td>
            <td>{{ location.montant_total }}</td>
            <td>{{ location.get_statut_paiement_display }}</td>
            <td>
                {% if paiements_par_chambre.location.id %}
                    <table border="1">
                        <thead>
                            <tr>
                                <th>Date</th>
                                <th>Montant</th>
                                <th>Mode</th>
                                <th>Statut</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for paiement in paiements_par_chambre.location.id %}
                            <tr>
                                <td>{{ paiement.date_paiement }}</td>
                                <td>{{ paiement.montant_paye }}</td>
                                <td>{{ paiement.get_mode_paiement_display }}</td>
                                <td>{{ paiement.get_statut_paiement_display }}</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                {% else %}
                    <p>Aucun paiement enregistré.</p>
                {% endif %}
            </td>
        </tr>
    {% endfor %}
    </tbody>
</table>
{% else %}
    <p>Aucune location en cours.</p>
{% endif %}

<h3>Locations Terminées</h3>
{% if fins_locations %}
<table border="1">
    <thead>
        <tr>
            <th>Date de fin</th>
            <th>Montant Restant</th>
            <th>Raison</th>
        </tr>
    </thead>
    <tbody>
        {% for fin in fins_locations %}
        <tr>
            <td>{{ fin.date_fin_location }}</td>
            <td>{{ fin.montant_restant }}</td>
            <td>{{ fin.raison_fin }}</td>
        </tr>
        {% endfor %}
    </tbody>
</table>
{% else %}
    <p>Aucune location terminée.</p>
{% endif %}

{% endblock %}





{% comment %} <tbody>
    {% for fin_location in fins_locations %}
    <tr>
        <td>{{ fin_location.date_fin_location }}</td>
        <td>{{ fin_location.montant_restant }}</td>
        <td>{{ fin_location.raison_fin }}</td>
    </tr>
    {% endfor %}
</tbody> {% endcomment %}

{% comment %} {% extends "accuiel/base.html" %}
{% block content %}


<h2>Locations Actuelles</h2>
{% if locations %}
    <table>
        <thead>
            <tr>
                <th>Chambre</th>
                <th>Début</th>
                <th>Montant Total</th>
                <th>Statut</th>
            </tr>
        </thead>
        <tbody>
            {% for location in locations %}
            <tr>
                <td>{{ location.chambre }}</td>
                <td>{{ location.date_debut_location }}</td>
                <td>{{ location.montant_total }}</td>
                <td>{{ location.get_statut_paiement_display }}</td> <!-- Pour afficher le choix lisible d'un statut si c'est un choix -->
            </tr>
            {% endfor %}
        </tbody>
    </table>
{% else %}
    <p>Aucune location actuelle.</p>
{% endif %}

<h2>Paiements</h2>
{% if paiements %}
    <table>
        <thead>
            <tr>
                <th>Date</th>
                <th>Montant</th>
                <th>Mode de Paiement</th>
                <th>Statut</th>
            </tr>
        </thead>
         <tbody>
            {% for paiement in paiements %}
            <tr>
                <td>{{ paiement.date_paiement }}</td>
                <td>{{ paiement.montant_paye }}</td>
                <td>{{ paiement.get_mode_paiement_display }}</td> <!-- Si c'est un choix, afficher la valeur lisible -->
                <td>{{ paiement.get_statut_paiement_display }}</td> <!-- Si c'est un choix, afficher la valeur lisible -->
            </tr>
            {% endfor %}
        </tbody>
    </table>
{% else %}
    <p>Aucun paiement enregistré.</p>
{% endif %}

<h2>Fin des Locations</h2>
{% if fins_locations %}
    <table>
        <thead>
            <tr>
                <th>Date de Fin</th>
                <th>Montant Restant</th>
                <th>Raison</th>
            </tr>
        </thead>
        <tbody>
            {% for fin_location in fins_locations %}
            <tr>
                <td>{{ fin_location.date_fin_location }}</td>
                <td>{{ fin_location.montant_restant }}</td>
                <td>{{ fin_location.raison_fin }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
{% else %}
    <p>Aucune location terminée.</p>
{% endif %}
{% endblock %} {% endcomment %}