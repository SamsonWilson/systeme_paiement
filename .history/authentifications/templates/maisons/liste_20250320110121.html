{% extends "accuiel/base.html" %}

{% block content %}
<div class="container mt-4">
    <h2>{% if maison %}Modifier{% else %}Ajouter{% endif %} une maison</h2>
    <form method="post" enctype="multipart/form-data">
        {% csrf_token %}
        
        <table class="table table-bordered">
            <!-- Nom de la maison -->
            <tr>
                <th><label for="{{ form.nom.id_for_label }}">Nom de la maison</label></th>
                <td>
                    {{ form.nom }}
                    {% if form.nom.errors %}
                        <div class="text-danger">
                            {{ form.nom.errors }}
                        </div>
                    {% endif %}
                </td>
            </tr>

            <!-- Adresse -->
            <tr>
                <th><label for="{{ form.adresse.id_for_label }}">Adresse</label></th>
                <td>
                    {{ form.adresse }}
                    {% if form.adresse.errors %}
                        <div class="text-danger">
                            {{ form.adresse.errors }}
                        </div>
                    {% endif %}
                </td>
            </tr>

            <!-- Code Postal -->
            <tr>
                <th><label for="{{ form.code_postal.id_for_label }}">Code Postal</label></th>
                <td>
                    {{ form.code_postal }}
                    {% if form.code_postal.errors %}
                        <div class="text-danger">
                            {{ form.code_postal.errors }}
                        </div>
                    {% endif %}
                </td>
            </tr>

            <!-- Quartier -->
            <tr>
                <th><label for="{{ form.quartier.id_for_label }}">Quartier</label></th>
                <td>
                    {{ form.quartier }}
                    {% if form.quartier.errors %}
                        <div class="text-danger">
                            {{ form.quartier.errors }}
                        </div>
                    {% endif %}
                </td>
            </tr>

            <!-- Image -->
            <tr>
                <th><label for="{{ form.image.id_for_label }}">Image de la maison</label></th>
                <td>
                    {{ form.image }}
                    {% if form.image.errors %}
                        <div class="text-danger">
                            {{ form.image.errors }}
                        </div>
                    {% endif %}
                    <!-- Aperçu de l'image -->
                    <img id="image-preview" src="#" alt="Aperçu de l'image" style="display: none; max-width: 200px; margin-top: 10px;">
                </td>
            </tr>
        </table>

        <!-- Bouton de soumission -->
        <div class="text-right">
            <button type="submit" class="btn btn-primary">
                {% if maison %}Modifier{% else %}Ajouter{% endif %}
            </button>
            <a href="{% url 'maison_liste' %}" class="btn btn-secondary">Annuler</a>
        </div>
    </form>
</div>

<!-- Script pour l'aperçu de l'image -->
<script>
    function previewImage(event) {
        const reader = new FileReader();
        const imagePreview = document.getElementById('image-preview');
        reader.onload = function() {
            imagePreview.src = reader.result;
            imagePreview.style.display = 'block';
        };
        reader.readAsDataURL(event.target.files[0]);
    }
    document.getElementById('id_image').addEventListener('change', previewImage);
</script>
{% endblock %}